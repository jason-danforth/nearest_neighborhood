{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 194,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from pprint import pprint\n",
    "from sqlalchemy import create_engine\n",
    "from sklearn.neighbors import NearestNeighbors\n",
    "\n",
    "# Set pandas to display numbers with commas\n",
    "pd.options.display.float_format = '{:,}'.format"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Import and Clean Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>zipcode</th>\n",
       "      <th>borough</th>\n",
       "      <th>borocode</th>\n",
       "      <th>landuse</th>\n",
       "      <th>bldgarea</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>611,625.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>13,489.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>34,000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2,008.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   zipcode borough  borocode  landuse  bldgarea\n",
       "0 10,001.0      MN       1.0      5.0 611,625.0\n",
       "1 10,001.0      MN       1.0      4.0  13,489.0\n",
       "2 10,001.0      MN       1.0      5.0  34,000.0\n",
       "3 10,001.0      MN       1.0     11.0       0.0\n",
       "4 10,001.0      MN       1.0      5.0   2,008.0"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# import and clean data\n",
    "\n",
    "pluto_df = pd.read_csv(\"pluto.csv\")\n",
    "pluto_df.sort_values(by=\"zipcode\", inplace=True)\n",
    "pluto_df = pluto_df.reset_index(drop=True).copy()\n",
    "pluto_df.dropna(inplace=True)\n",
    "pluto_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>zipcode</th>\n",
       "      <th>borough</th>\n",
       "      <th>borocode</th>\n",
       "      <th>bldgarea</th>\n",
       "      <th>1.0</th>\n",
       "      <th>2.0</th>\n",
       "      <th>3.0</th>\n",
       "      <th>4.0</th>\n",
       "      <th>5.0</th>\n",
       "      <th>6.0</th>\n",
       "      <th>7.0</th>\n",
       "      <th>8.0</th>\n",
       "      <th>9.0</th>\n",
       "      <th>10.0</th>\n",
       "      <th>11.0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>611,625.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>13,489.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>34,000.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2,008.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   zipcode borough  borocode  bldgarea  1.0  2.0  3.0  4.0  5.0  6.0  7.0  \\\n",
       "0 10,001.0      MN       1.0 611,625.0    0    0    0    0    1    0    0   \n",
       "1 10,001.0      MN       1.0  13,489.0    0    0    0    1    0    0    0   \n",
       "2 10,001.0      MN       1.0  34,000.0    0    0    0    0    1    0    0   \n",
       "3 10,001.0      MN       1.0       0.0    0    0    0    0    0    0    0   \n",
       "4 10,001.0      MN       1.0   2,008.0    0    0    0    0    1    0    0   \n",
       "\n",
       "   8.0  9.0  10.0  11.0  \n",
       "0    0    0     0     0  \n",
       "1    0    0     0     0  \n",
       "2    0    0     0     0  \n",
       "3    0    0     0     1  \n",
       "4    0    0     0     0  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#One hot encoding for landuse\n",
    "\n",
    "dummy_df = pd.get_dummies(pluto_df.landuse)\n",
    "pluto_df.drop(\"landuse\", axis=1, inplace=True)\n",
    "data_df = pluto_df.join(dummy_df)\n",
    "data_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>zipcode</th>\n",
       "      <th>borough</th>\n",
       "      <th>borocode</th>\n",
       "      <th>1.0</th>\n",
       "      <th>2.0</th>\n",
       "      <th>3.0</th>\n",
       "      <th>4.0</th>\n",
       "      <th>5.0</th>\n",
       "      <th>6.0</th>\n",
       "      <th>7.0</th>\n",
       "      <th>8.0</th>\n",
       "      <th>9.0</th>\n",
       "      <th>10.0</th>\n",
       "      <th>11.0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>611,625.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13,489.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>34,000.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>MN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2,008.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   zipcode borough  borocode  1.0  2.0  3.0      4.0       5.0  6.0  7.0  8.0  \\\n",
       "0 10,001.0      MN       1.0  0.0  0.0  0.0      0.0 611,625.0  0.0  0.0  0.0   \n",
       "1 10,001.0      MN       1.0  0.0  0.0  0.0 13,489.0       0.0  0.0  0.0  0.0   \n",
       "2 10,001.0      MN       1.0  0.0  0.0  0.0      0.0  34,000.0  0.0  0.0  0.0   \n",
       "3 10,001.0      MN       1.0  0.0  0.0  0.0      0.0       0.0  0.0  0.0  0.0   \n",
       "4 10,001.0      MN       1.0  0.0  0.0  0.0      0.0   2,008.0  0.0  0.0  0.0   \n",
       "\n",
       "   9.0  10.0  11.0  \n",
       "0  0.0   0.0   0.0  \n",
       "1  0.0   0.0   0.0  \n",
       "2  0.0   0.0   0.0  \n",
       "3  0.0   0.0   0.0  \n",
       "4  0.0   0.0   0.0  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Associate bldgarea with landuse values\n",
    "\n",
    "cols = [1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0]\n",
    "for col in cols:\n",
    "    data_df[col] = data_df[col] * data_df.bldgarea\n",
    "data_df.drop(\"bldgarea\", axis=1, inplace=True)\n",
    "data_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>zipcode</th>\n",
       "      <th>borocode</th>\n",
       "      <th>1.0</th>\n",
       "      <th>2.0</th>\n",
       "      <th>3.0</th>\n",
       "      <th>4.0</th>\n",
       "      <th>5.0</th>\n",
       "      <th>6.0</th>\n",
       "      <th>7.0</th>\n",
       "      <th>8.0</th>\n",
       "      <th>9.0</th>\n",
       "      <th>10.0</th>\n",
       "      <th>11.0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>33,606.0</td>\n",
       "      <td>592,289.0</td>\n",
       "      <td>8,350,224.0</td>\n",
       "      <td>13,875,477.0</td>\n",
       "      <td>53,005,101.0</td>\n",
       "      <td>4,445,633.0</td>\n",
       "      <td>1,182,594.0</td>\n",
       "      <td>10,895,555.0</td>\n",
       "      <td>1,152,624.0</td>\n",
       "      <td>616,150.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10,002.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>51,117.0</td>\n",
       "      <td>1,938,379.0</td>\n",
       "      <td>16,618,352.0</td>\n",
       "      <td>16,356,822.0</td>\n",
       "      <td>3,200,967.0</td>\n",
       "      <td>1,182,700.0</td>\n",
       "      <td>590,077.0</td>\n",
       "      <td>4,618,645.0</td>\n",
       "      <td>87,067.0</td>\n",
       "      <td>252,263.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10,003.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>515,395.0</td>\n",
       "      <td>3,786,590.0</td>\n",
       "      <td>12,746,613.0</td>\n",
       "      <td>15,687,708.0</td>\n",
       "      <td>10,760,299.0</td>\n",
       "      <td>714,504.0</td>\n",
       "      <td>3,459.0</td>\n",
       "      <td>9,501,989.0</td>\n",
       "      <td>126,922.0</td>\n",
       "      <td>159,151.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10,004.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>725,023.0</td>\n",
       "      <td>4,194,913.0</td>\n",
       "      <td>21,117,265.0</td>\n",
       "      <td>85,472.0</td>\n",
       "      <td>462,543.0</td>\n",
       "      <td>3,722,844.0</td>\n",
       "      <td>945,425.0</td>\n",
       "      <td>87,775.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10,005.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2,480,663.0</td>\n",
       "      <td>5,683,041.0</td>\n",
       "      <td>16,515,733.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>682,450.0</td>\n",
       "      <td>43,568.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   zipcode  borocode       1.0         2.0          3.0          4.0  \\\n",
       "0 10,001.0       1.0  33,606.0   592,289.0  8,350,224.0 13,875,477.0   \n",
       "1 10,002.0       1.0  51,117.0 1,938,379.0 16,618,352.0 16,356,822.0   \n",
       "2 10,003.0       1.0 515,395.0 3,786,590.0 12,746,613.0 15,687,708.0   \n",
       "3 10,004.0       1.0       0.0         0.0    725,023.0  4,194,913.0   \n",
       "4 10,005.0       1.0       0.0         0.0  2,480,663.0  5,683,041.0   \n",
       "\n",
       "           5.0         6.0         7.0          8.0         9.0      10.0  \\\n",
       "0 53,005,101.0 4,445,633.0 1,182,594.0 10,895,555.0 1,152,624.0 616,150.0   \n",
       "1  3,200,967.0 1,182,700.0   590,077.0  4,618,645.0    87,067.0 252,263.0   \n",
       "2 10,760,299.0   714,504.0     3,459.0  9,501,989.0   126,922.0 159,151.0   \n",
       "3 21,117,265.0    85,472.0   462,543.0  3,722,844.0   945,425.0  87,775.0   \n",
       "4 16,515,733.0         0.0   682,450.0     43,568.0         0.0       0.0   \n",
       "\n",
       "   11.0  \n",
       "0   0.0  \n",
       "1   0.0  \n",
       "2   0.0  \n",
       "3   0.0  \n",
       "4   0.0  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create summary data\n",
    "\n",
    "data_df.drop(\"borough\", axis=1, inplace=True)\n",
    "landuse_df = data_df.groupby(\"zipcode\").agg({'borocode':'median',\n",
    "                                                1.0:'sum',\n",
    "                                                2.0:'sum',\n",
    "                                                3.0:'sum',\n",
    "                                                4.0:'sum', \n",
    "                                                5.0:'sum',\n",
    "                                                6.0:'sum',\n",
    "                                                7.0:'sum',\n",
    "                                                8.0:'sum',\n",
    "                                                9.0:'sum',\n",
    "                                                10.0:'sum',\n",
    "                                                11.0:'sum'})\n",
    "landuse_df.reset_index(inplace=True)\n",
    "landuse_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# Relabel borocode so easy to remember (had to drop above b/c groupby only accepts numeric columns)\n",
    "\n",
    "boro_dict = {\"Manhattan\": 1.0, \n",
    "             \"Bronx\": 2.0, \n",
    "             \"Brooklyn\": 3.0, \n",
    "             \"Queens\": 4.0, \n",
    "             \"Staten Island\": 5.0}\n",
    "\n",
    "def relabel(num):\n",
    "    boros = list(boro_dict.keys())\n",
    "    values = list(boro_dict.values())    \n",
    "    return boros[values.index(num)]\n",
    "\n",
    "landuse_df['borocode'] = landuse_df['borocode'].apply(relabel)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "cols_dict = {1.0: \"1 & 2 Family Residential\",\n",
    "             2.0: \"Multi-Family Walk-up\",\n",
    "             3.0: \"Multi-Family Elevator\",\n",
    "             4.0: \"Mixed Residential & Commercial\",\n",
    "             5.0: \"Commercial & Office\",\n",
    "             6.0: \"Industrial & Manufacturing\",\n",
    "             7.0: \"Transportation & Utility\",\n",
    "             8.0: \"Public Facilities & Institutions\",\n",
    "             9.0: \"Open Space & Outdoor Recreation\",\n",
    "             10.0: \"Parking\",\n",
    "             11.0: \"Vacant Land\"}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>zipcode</th>\n",
       "      <th>borocode</th>\n",
       "      <th>1 &amp; 2 Family Residential</th>\n",
       "      <th>Multi-Family Walk-up</th>\n",
       "      <th>Multi-Family Elevator</th>\n",
       "      <th>Mixed Residential &amp; Commercial</th>\n",
       "      <th>Commercial &amp; Office</th>\n",
       "      <th>Industrial &amp; Manufacturing</th>\n",
       "      <th>Transportation &amp; Utility</th>\n",
       "      <th>Public Facilities &amp; Institutions</th>\n",
       "      <th>Open Space &amp; Outdoor Recreation</th>\n",
       "      <th>Parking</th>\n",
       "      <th>Vacant Land</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>33,606.0</td>\n",
       "      <td>592,289.0</td>\n",
       "      <td>8,350,224.0</td>\n",
       "      <td>13,875,477.0</td>\n",
       "      <td>53,005,101.0</td>\n",
       "      <td>4,445,633.0</td>\n",
       "      <td>1,182,594.0</td>\n",
       "      <td>10,895,555.0</td>\n",
       "      <td>1,152,624.0</td>\n",
       "      <td>616,150.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10,002.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>51,117.0</td>\n",
       "      <td>1,938,379.0</td>\n",
       "      <td>16,618,352.0</td>\n",
       "      <td>16,356,822.0</td>\n",
       "      <td>3,200,967.0</td>\n",
       "      <td>1,182,700.0</td>\n",
       "      <td>590,077.0</td>\n",
       "      <td>4,618,645.0</td>\n",
       "      <td>87,067.0</td>\n",
       "      <td>252,263.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10,003.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>515,395.0</td>\n",
       "      <td>3,786,590.0</td>\n",
       "      <td>12,746,613.0</td>\n",
       "      <td>15,687,708.0</td>\n",
       "      <td>10,760,299.0</td>\n",
       "      <td>714,504.0</td>\n",
       "      <td>3,459.0</td>\n",
       "      <td>9,501,989.0</td>\n",
       "      <td>126,922.0</td>\n",
       "      <td>159,151.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10,004.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>725,023.0</td>\n",
       "      <td>4,194,913.0</td>\n",
       "      <td>21,117,265.0</td>\n",
       "      <td>85,472.0</td>\n",
       "      <td>462,543.0</td>\n",
       "      <td>3,722,844.0</td>\n",
       "      <td>945,425.0</td>\n",
       "      <td>87,775.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10,005.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2,480,663.0</td>\n",
       "      <td>5,683,041.0</td>\n",
       "      <td>16,515,733.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>682,450.0</td>\n",
       "      <td>43,568.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>10,006.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2,406,484.0</td>\n",
       "      <td>1,409,933.0</td>\n",
       "      <td>7,224,839.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>237,019.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>305,026.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>10,007.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>11,515.0</td>\n",
       "      <td>135,365.0</td>\n",
       "      <td>25,180,716.0</td>\n",
       "      <td>7,113,948.0</td>\n",
       "      <td>26,421,102.0</td>\n",
       "      <td>186,711.0</td>\n",
       "      <td>6,565.0</td>\n",
       "      <td>1,964,664.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>10,009.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>49,533.0</td>\n",
       "      <td>4,551,976.0</td>\n",
       "      <td>7,867,831.0</td>\n",
       "      <td>16,437,543.0</td>\n",
       "      <td>1,094,334.0</td>\n",
       "      <td>132,152.0</td>\n",
       "      <td>175,000.0</td>\n",
       "      <td>1,778,954.0</td>\n",
       "      <td>52,703.0</td>\n",
       "      <td>3,358.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>10,010.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>35,514.0</td>\n",
       "      <td>671,530.0</td>\n",
       "      <td>7,188,028.0</td>\n",
       "      <td>14,478,911.0</td>\n",
       "      <td>16,348,068.0</td>\n",
       "      <td>316,637.0</td>\n",
       "      <td>65,745.0</td>\n",
       "      <td>5,288,022.0</td>\n",
       "      <td>20,206.0</td>\n",
       "      <td>84,013.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10,011.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>1,029,569.0</td>\n",
       "      <td>4,471,226.0</td>\n",
       "      <td>14,800,035.0</td>\n",
       "      <td>18,123,314.0</td>\n",
       "      <td>15,296,761.0</td>\n",
       "      <td>1,648,286.0</td>\n",
       "      <td>464,332.0</td>\n",
       "      <td>4,294,146.0</td>\n",
       "      <td>12,323.0</td>\n",
       "      <td>78,016.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>10,012.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>145,551.0</td>\n",
       "      <td>1,454,433.0</td>\n",
       "      <td>4,613,138.0</td>\n",
       "      <td>9,531,808.0</td>\n",
       "      <td>6,921,166.0</td>\n",
       "      <td>701,519.0</td>\n",
       "      <td>2,303.0</td>\n",
       "      <td>5,400,219.0</td>\n",
       "      <td>825.0</td>\n",
       "      <td>81,080.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>10,013.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>195,307.0</td>\n",
       "      <td>1,131,087.0</td>\n",
       "      <td>5,779,311.0</td>\n",
       "      <td>56,057,948.0</td>\n",
       "      <td>18,849,057.0</td>\n",
       "      <td>2,494,273.0</td>\n",
       "      <td>277,723.0</td>\n",
       "      <td>4,696,390.0</td>\n",
       "      <td>20,783.0</td>\n",
       "      <td>252,788.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>10,014.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>1,491,761.0</td>\n",
       "      <td>4,724,791.0</td>\n",
       "      <td>7,474,829.0</td>\n",
       "      <td>8,185,370.0</td>\n",
       "      <td>10,160,665.0</td>\n",
       "      <td>416,587.0</td>\n",
       "      <td>767,117.0</td>\n",
       "      <td>1,278,432.0</td>\n",
       "      <td>54,398.0</td>\n",
       "      <td>255,804.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>10,016.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>326,668.0</td>\n",
       "      <td>1,390,578.0</td>\n",
       "      <td>13,831,161.0</td>\n",
       "      <td>22,955,466.0</td>\n",
       "      <td>29,604,440.0</td>\n",
       "      <td>670,902.0</td>\n",
       "      <td>6,150.0</td>\n",
       "      <td>7,599,194.0</td>\n",
       "      <td>12,406.0</td>\n",
       "      <td>261,082.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>10,017.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>147,059.0</td>\n",
       "      <td>102,061.0</td>\n",
       "      <td>6,046,123.0</td>\n",
       "      <td>6,548,307.0</td>\n",
       "      <td>59,741,723.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>74,550.0</td>\n",
       "      <td>3,863,733.0</td>\n",
       "      <td>796.0</td>\n",
       "      <td>61,700.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>10,018.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>291,891.0</td>\n",
       "      <td>3,240,209.0</td>\n",
       "      <td>4,078,905.0</td>\n",
       "      <td>34,754,916.0</td>\n",
       "      <td>4,832,798.0</td>\n",
       "      <td>2,240,173.0</td>\n",
       "      <td>1,651,025.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>679,012.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>10,019.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>39,569.0</td>\n",
       "      <td>1,841,651.0</td>\n",
       "      <td>12,189,484.0</td>\n",
       "      <td>34,487,557.0</td>\n",
       "      <td>45,803,364.0</td>\n",
       "      <td>473,962.0</td>\n",
       "      <td>777,575.0</td>\n",
       "      <td>5,264,467.0</td>\n",
       "      <td>20,600.0</td>\n",
       "      <td>191,488.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>10,020.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>18,000.0</td>\n",
       "      <td>12,212,344.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>10,021.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>1,585,705.0</td>\n",
       "      <td>1,889,263.0</td>\n",
       "      <td>20,806,893.0</td>\n",
       "      <td>13,542,249.0</td>\n",
       "      <td>1,997,043.0</td>\n",
       "      <td>2,400.0</td>\n",
       "      <td>28,097.0</td>\n",
       "      <td>6,228,936.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>222,378.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>10,022.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>330,406.0</td>\n",
       "      <td>878,302.0</td>\n",
       "      <td>19,038,305.0</td>\n",
       "      <td>16,970,483.0</td>\n",
       "      <td>47,958,268.0</td>\n",
       "      <td>55,175.0</td>\n",
       "      <td>116,360.0</td>\n",
       "      <td>1,589,981.0</td>\n",
       "      <td>912.0</td>\n",
       "      <td>206,094.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>10,023.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>652,042.0</td>\n",
       "      <td>3,811,309.0</td>\n",
       "      <td>21,279,942.0</td>\n",
       "      <td>25,785,893.0</td>\n",
       "      <td>3,974,104.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4,571,429.0</td>\n",
       "      <td>58,219.0</td>\n",
       "      <td>62,555.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>10,024.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>1,202,774.0</td>\n",
       "      <td>5,475,999.0</td>\n",
       "      <td>24,611,738.0</td>\n",
       "      <td>15,215,282.0</td>\n",
       "      <td>1,321,834.0</td>\n",
       "      <td>103,576.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3,887,400.0</td>\n",
       "      <td>4,700.0</td>\n",
       "      <td>147,492.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>10,025.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>500,570.0</td>\n",
       "      <td>4,928,668.0</td>\n",
       "      <td>32,659,777.0</td>\n",
       "      <td>14,682,226.0</td>\n",
       "      <td>1,606,729.0</td>\n",
       "      <td>127,322.0</td>\n",
       "      <td>23,703.0</td>\n",
       "      <td>19,291,758.0</td>\n",
       "      <td>27,963.0</td>\n",
       "      <td>295,453.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>10,026.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>329,033.0</td>\n",
       "      <td>3,847,017.0</td>\n",
       "      <td>6,602,068.0</td>\n",
       "      <td>5,660,989.0</td>\n",
       "      <td>166,654.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1,381,636.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>10,027.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>1,085,095.0</td>\n",
       "      <td>6,163,938.0</td>\n",
       "      <td>12,757,706.0</td>\n",
       "      <td>8,258,381.0</td>\n",
       "      <td>3,931,787.0</td>\n",
       "      <td>642,528.0</td>\n",
       "      <td>490,568.0</td>\n",
       "      <td>11,486,677.0</td>\n",
       "      <td>43,361.0</td>\n",
       "      <td>215,066.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>10,028.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>737,330.0</td>\n",
       "      <td>3,314,081.0</td>\n",
       "      <td>18,255,253.0</td>\n",
       "      <td>13,731,428.0</td>\n",
       "      <td>433,476.0</td>\n",
       "      <td>44,183.0</td>\n",
       "      <td>18,930.0</td>\n",
       "      <td>1,476,654.0</td>\n",
       "      <td>7,500.0</td>\n",
       "      <td>54,731.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>10,029.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>111,917.0</td>\n",
       "      <td>3,591,936.0</td>\n",
       "      <td>17,265,845.0</td>\n",
       "      <td>12,794,749.0</td>\n",
       "      <td>975,600.0</td>\n",
       "      <td>378,725.0</td>\n",
       "      <td>216,324.0</td>\n",
       "      <td>10,062,118.0</td>\n",
       "      <td>24,487.0</td>\n",
       "      <td>676,748.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>10,030.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>774,088.0</td>\n",
       "      <td>4,628,963.0</td>\n",
       "      <td>3,004,654.0</td>\n",
       "      <td>4,303,357.0</td>\n",
       "      <td>110,686.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1,341,992.0</td>\n",
       "      <td>1,410.0</td>\n",
       "      <td>56,356.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>10,031.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>1,242,521.0</td>\n",
       "      <td>6,383,009.0</td>\n",
       "      <td>9,886,916.0</td>\n",
       "      <td>5,265,342.0</td>\n",
       "      <td>453,007.0</td>\n",
       "      <td>222,311.0</td>\n",
       "      <td>26,017.0</td>\n",
       "      <td>3,936,851.0</td>\n",
       "      <td>13,600.0</td>\n",
       "      <td>46,200.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>10,032.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>345,169.0</td>\n",
       "      <td>5,406,723.0</td>\n",
       "      <td>9,011,038.0</td>\n",
       "      <td>7,150,092.0</td>\n",
       "      <td>510,310.0</td>\n",
       "      <td>24,714.0</td>\n",
       "      <td>24,170.0</td>\n",
       "      <td>11,198,145.0</td>\n",
       "      <td>258,931.0</td>\n",
       "      <td>671,660.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>182</th>\n",
       "      <td>11,411.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>6,888,611.0</td>\n",
       "      <td>88,292.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>70,619.0</td>\n",
       "      <td>299,776.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6,653.0</td>\n",
       "      <td>682,868.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183</th>\n",
       "      <td>11,412.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>12,250,978.0</td>\n",
       "      <td>340,837.0</td>\n",
       "      <td>154,824.0</td>\n",
       "      <td>736,562.0</td>\n",
       "      <td>344,338.0</td>\n",
       "      <td>527,030.0</td>\n",
       "      <td>84,582.0</td>\n",
       "      <td>1,006,467.0</td>\n",
       "      <td>612.0</td>\n",
       "      <td>3,242.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>184</th>\n",
       "      <td>11,413.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>13,998,504.0</td>\n",
       "      <td>353,908.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>182,737.0</td>\n",
       "      <td>752,809.0</td>\n",
       "      <td>1,949,320.0</td>\n",
       "      <td>62,229.0</td>\n",
       "      <td>1,174,929.0</td>\n",
       "      <td>9,656.0</td>\n",
       "      <td>4,900.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>185</th>\n",
       "      <td>11,414.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>9,751,254.0</td>\n",
       "      <td>2,245,988.0</td>\n",
       "      <td>2,090,642.0</td>\n",
       "      <td>289,219.0</td>\n",
       "      <td>892,523.0</td>\n",
       "      <td>1,400.0</td>\n",
       "      <td>3,006.0</td>\n",
       "      <td>504,989.0</td>\n",
       "      <td>8,044.0</td>\n",
       "      <td>800.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>186</th>\n",
       "      <td>11,415.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>1,782,564.0</td>\n",
       "      <td>1,322,692.0</td>\n",
       "      <td>5,196,781.0</td>\n",
       "      <td>1,759,878.0</td>\n",
       "      <td>994,338.0</td>\n",
       "      <td>34,487.0</td>\n",
       "      <td>4,705.0</td>\n",
       "      <td>780,491.0</td>\n",
       "      <td>20,303.0</td>\n",
       "      <td>4,902.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>187</th>\n",
       "      <td>11,416.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>4,808,177.0</td>\n",
       "      <td>1,499,972.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>883,024.0</td>\n",
       "      <td>576,513.0</td>\n",
       "      <td>466,978.0</td>\n",
       "      <td>141,183.0</td>\n",
       "      <td>701,896.0</td>\n",
       "      <td>904.0</td>\n",
       "      <td>24,385.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>188</th>\n",
       "      <td>11,417.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>7,554,870.0</td>\n",
       "      <td>1,579,158.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>733,693.0</td>\n",
       "      <td>568,005.0</td>\n",
       "      <td>468,406.0</td>\n",
       "      <td>80,598.0</td>\n",
       "      <td>1,244,651.0</td>\n",
       "      <td>69,755.0</td>\n",
       "      <td>33,567.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>189</th>\n",
       "      <td>11,418.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>6,989,644.0</td>\n",
       "      <td>2,473,063.0</td>\n",
       "      <td>1,892,226.0</td>\n",
       "      <td>1,718,639.0</td>\n",
       "      <td>1,267,287.0</td>\n",
       "      <td>1,583,916.0</td>\n",
       "      <td>75,974.0</td>\n",
       "      <td>1,968,887.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>101,247.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>190</th>\n",
       "      <td>11,419.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>9,880,447.0</td>\n",
       "      <td>1,641,139.0</td>\n",
       "      <td>46,760.0</td>\n",
       "      <td>1,477,640.0</td>\n",
       "      <td>686,233.0</td>\n",
       "      <td>160,051.0</td>\n",
       "      <td>49,411.0</td>\n",
       "      <td>626,089.0</td>\n",
       "      <td>900.0</td>\n",
       "      <td>3,138.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>191</th>\n",
       "      <td>11,420.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>12,498,809.0</td>\n",
       "      <td>651,728.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>684,550.0</td>\n",
       "      <td>511,211.0</td>\n",
       "      <td>53,846.0</td>\n",
       "      <td>76,802.0</td>\n",
       "      <td>1,159,866.0</td>\n",
       "      <td>2,058,532.0</td>\n",
       "      <td>3,024.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>192</th>\n",
       "      <td>11,421.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>8,803,973.0</td>\n",
       "      <td>2,132,043.0</td>\n",
       "      <td>1,243,736.0</td>\n",
       "      <td>1,273,895.0</td>\n",
       "      <td>296,284.0</td>\n",
       "      <td>82,028.0</td>\n",
       "      <td>22,221.0</td>\n",
       "      <td>455,308.0</td>\n",
       "      <td>27,240.0</td>\n",
       "      <td>3,700.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>193</th>\n",
       "      <td>11,422.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>9,791,071.0</td>\n",
       "      <td>912,028.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>185,024.0</td>\n",
       "      <td>630,759.0</td>\n",
       "      <td>81,696.0</td>\n",
       "      <td>13,017.0</td>\n",
       "      <td>613,022.0</td>\n",
       "      <td>1,125.0</td>\n",
       "      <td>7,660.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>194</th>\n",
       "      <td>11,423.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>8,087,531.0</td>\n",
       "      <td>1,216,244.0</td>\n",
       "      <td>1,678,238.0</td>\n",
       "      <td>648,308.0</td>\n",
       "      <td>419,783.0</td>\n",
       "      <td>1,026,553.0</td>\n",
       "      <td>94,138.0</td>\n",
       "      <td>839,545.0</td>\n",
       "      <td>1,360.0</td>\n",
       "      <td>70,060.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>195</th>\n",
       "      <td>11,426.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>5,968,291.0</td>\n",
       "      <td>925,217.0</td>\n",
       "      <td>263,883.0</td>\n",
       "      <td>140,416.0</td>\n",
       "      <td>419,374.0</td>\n",
       "      <td>137,706.0</td>\n",
       "      <td>12,273.0</td>\n",
       "      <td>1,077,723.0</td>\n",
       "      <td>1,511.0</td>\n",
       "      <td>4,092.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>196</th>\n",
       "      <td>11,427.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>6,473,320.0</td>\n",
       "      <td>2,439,732.0</td>\n",
       "      <td>437,087.0</td>\n",
       "      <td>156,580.0</td>\n",
       "      <td>194,145.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5,985.0</td>\n",
       "      <td>2,444,529.0</td>\n",
       "      <td>8,832.0</td>\n",
       "      <td>2,200.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>11,428.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>5,666,382.0</td>\n",
       "      <td>413,322.0</td>\n",
       "      <td>200,737.0</td>\n",
       "      <td>619,449.0</td>\n",
       "      <td>486,854.0</td>\n",
       "      <td>123,195.0</td>\n",
       "      <td>54,336.0</td>\n",
       "      <td>781,900.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1,560.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>198</th>\n",
       "      <td>11,429.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>7,973,836.0</td>\n",
       "      <td>250,522.0</td>\n",
       "      <td>98,116.0</td>\n",
       "      <td>286,292.0</td>\n",
       "      <td>295,565.0</td>\n",
       "      <td>452,708.0</td>\n",
       "      <td>320,215.0</td>\n",
       "      <td>569,612.0</td>\n",
       "      <td>800.0</td>\n",
       "      <td>14,225.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>11,430.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>145,538.0</td>\n",
       "      <td>42,400.0</td>\n",
       "      <td>17,280,787.0</td>\n",
       "      <td>29,000.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1,575.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>11,432.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>9,994,580.0</td>\n",
       "      <td>1,929,693.0</td>\n",
       "      <td>7,378,154.0</td>\n",
       "      <td>4,107,566.0</td>\n",
       "      <td>2,917,690.0</td>\n",
       "      <td>11,270.0</td>\n",
       "      <td>16,398.0</td>\n",
       "      <td>10,079,934.0</td>\n",
       "      <td>1,000.0</td>\n",
       "      <td>347,427.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201</th>\n",
       "      <td>11,433.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>7,905,595.0</td>\n",
       "      <td>1,137,226.0</td>\n",
       "      <td>1,509,858.0</td>\n",
       "      <td>679,882.0</td>\n",
       "      <td>2,593,100.0</td>\n",
       "      <td>2,103,300.0</td>\n",
       "      <td>335,764.0</td>\n",
       "      <td>2,414,571.0</td>\n",
       "      <td>12,590.0</td>\n",
       "      <td>303,009.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>202</th>\n",
       "      <td>11,434.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>14,424,636.0</td>\n",
       "      <td>420,494.0</td>\n",
       "      <td>8,870,953.0</td>\n",
       "      <td>528,147.0</td>\n",
       "      <td>1,808,663.0</td>\n",
       "      <td>2,275,456.0</td>\n",
       "      <td>179,473.0</td>\n",
       "      <td>2,814,011.0</td>\n",
       "      <td>56,693.0</td>\n",
       "      <td>269,331.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>203</th>\n",
       "      <td>11,435.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>7,263,755.0</td>\n",
       "      <td>3,191,866.0</td>\n",
       "      <td>6,810,531.0</td>\n",
       "      <td>2,655,828.0</td>\n",
       "      <td>2,468,101.0</td>\n",
       "      <td>952,046.0</td>\n",
       "      <td>171,412.0</td>\n",
       "      <td>2,453,715.0</td>\n",
       "      <td>42,550.0</td>\n",
       "      <td>164,576.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>204</th>\n",
       "      <td>11,436.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>5,577,045.0</td>\n",
       "      <td>76,479.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>171,534.0</td>\n",
       "      <td>919,551.0</td>\n",
       "      <td>20,928.0</td>\n",
       "      <td>10,334.0</td>\n",
       "      <td>688,660.0</td>\n",
       "      <td>600.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>205</th>\n",
       "      <td>11,691.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>9,979,445.0</td>\n",
       "      <td>2,379,913.0</td>\n",
       "      <td>9,220,076.0</td>\n",
       "      <td>1,378,914.0</td>\n",
       "      <td>904,570.0</td>\n",
       "      <td>387,791.0</td>\n",
       "      <td>141,782.0</td>\n",
       "      <td>3,118,445.0</td>\n",
       "      <td>22,917.0</td>\n",
       "      <td>15,738.0</td>\n",
       "      <td>4,168.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>206</th>\n",
       "      <td>11,692.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>4,017,419.0</td>\n",
       "      <td>536,551.0</td>\n",
       "      <td>3,390,311.0</td>\n",
       "      <td>312,001.0</td>\n",
       "      <td>139,526.0</td>\n",
       "      <td>82,475.0</td>\n",
       "      <td>43,445.0</td>\n",
       "      <td>632,900.0</td>\n",
       "      <td>75,638.0</td>\n",
       "      <td>49,304.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207</th>\n",
       "      <td>11,693.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>2,007,137.0</td>\n",
       "      <td>497,075.0</td>\n",
       "      <td>3,057,924.0</td>\n",
       "      <td>167,249.0</td>\n",
       "      <td>191,077.0</td>\n",
       "      <td>297,651.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>382,212.0</td>\n",
       "      <td>66,441.0</td>\n",
       "      <td>16,344.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>208</th>\n",
       "      <td>11,694.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>6,462,296.0</td>\n",
       "      <td>1,523,505.0</td>\n",
       "      <td>2,726,703.0</td>\n",
       "      <td>568,939.0</td>\n",
       "      <td>577,988.0</td>\n",
       "      <td>37,309.0</td>\n",
       "      <td>27,067.0</td>\n",
       "      <td>1,570,910.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4,500.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>209</th>\n",
       "      <td>11,695.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>62,000.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>210</th>\n",
       "      <td>11,697.0</td>\n",
       "      <td>Queens</td>\n",
       "      <td>2,411,300.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>261,550.0</td>\n",
       "      <td>12,252,000.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>211</th>\n",
       "      <td>12,345.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>25,456.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>212 rows  13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     zipcode   borocode  1 & 2 Family Residential  Multi-Family Walk-up  \\\n",
       "0   10,001.0  Manhattan                  33,606.0             592,289.0   \n",
       "1   10,002.0  Manhattan                  51,117.0           1,938,379.0   \n",
       "2   10,003.0  Manhattan                 515,395.0           3,786,590.0   \n",
       "3   10,004.0  Manhattan                       0.0                   0.0   \n",
       "4   10,005.0  Manhattan                       0.0                   0.0   \n",
       "5   10,006.0  Manhattan                       0.0                   0.0   \n",
       "6   10,007.0  Manhattan                  11,515.0             135,365.0   \n",
       "7   10,009.0  Manhattan                  49,533.0           4,551,976.0   \n",
       "8   10,010.0  Manhattan                  35,514.0             671,530.0   \n",
       "9   10,011.0  Manhattan               1,029,569.0           4,471,226.0   \n",
       "10  10,012.0  Manhattan                 145,551.0           1,454,433.0   \n",
       "11  10,013.0  Manhattan                 195,307.0           1,131,087.0   \n",
       "12  10,014.0  Manhattan               1,491,761.0           4,724,791.0   \n",
       "13  10,016.0  Manhattan                 326,668.0           1,390,578.0   \n",
       "14  10,017.0  Manhattan                 147,059.0             102,061.0   \n",
       "15  10,018.0  Manhattan                       0.0             291,891.0   \n",
       "16  10,019.0  Manhattan                  39,569.0           1,841,651.0   \n",
       "17  10,020.0  Manhattan                       0.0                   0.0   \n",
       "18  10,021.0  Manhattan               1,585,705.0           1,889,263.0   \n",
       "19  10,022.0  Manhattan                 330,406.0             878,302.0   \n",
       "20  10,023.0  Manhattan                 652,042.0           3,811,309.0   \n",
       "21  10,024.0  Manhattan               1,202,774.0           5,475,999.0   \n",
       "22  10,025.0  Manhattan                 500,570.0           4,928,668.0   \n",
       "23  10,026.0  Manhattan                 329,033.0           3,847,017.0   \n",
       "24  10,027.0  Manhattan               1,085,095.0           6,163,938.0   \n",
       "25  10,028.0  Manhattan                 737,330.0           3,314,081.0   \n",
       "26  10,029.0  Manhattan                 111,917.0           3,591,936.0   \n",
       "27  10,030.0  Manhattan                 774,088.0           4,628,963.0   \n",
       "28  10,031.0  Manhattan               1,242,521.0           6,383,009.0   \n",
       "29  10,032.0  Manhattan                 345,169.0           5,406,723.0   \n",
       "..       ...        ...                       ...                   ...   \n",
       "182 11,411.0     Queens               6,888,611.0              88,292.0   \n",
       "183 11,412.0     Queens              12,250,978.0             340,837.0   \n",
       "184 11,413.0     Queens              13,998,504.0             353,908.0   \n",
       "185 11,414.0     Queens               9,751,254.0           2,245,988.0   \n",
       "186 11,415.0     Queens               1,782,564.0           1,322,692.0   \n",
       "187 11,416.0     Queens               4,808,177.0           1,499,972.0   \n",
       "188 11,417.0     Queens               7,554,870.0           1,579,158.0   \n",
       "189 11,418.0     Queens               6,989,644.0           2,473,063.0   \n",
       "190 11,419.0     Queens               9,880,447.0           1,641,139.0   \n",
       "191 11,420.0     Queens              12,498,809.0             651,728.0   \n",
       "192 11,421.0     Queens               8,803,973.0           2,132,043.0   \n",
       "193 11,422.0     Queens               9,791,071.0             912,028.0   \n",
       "194 11,423.0     Queens               8,087,531.0           1,216,244.0   \n",
       "195 11,426.0     Queens               5,968,291.0             925,217.0   \n",
       "196 11,427.0     Queens               6,473,320.0           2,439,732.0   \n",
       "197 11,428.0     Queens               5,666,382.0             413,322.0   \n",
       "198 11,429.0     Queens               7,973,836.0             250,522.0   \n",
       "199 11,430.0     Queens                       0.0                   0.0   \n",
       "200 11,432.0     Queens               9,994,580.0           1,929,693.0   \n",
       "201 11,433.0     Queens               7,905,595.0           1,137,226.0   \n",
       "202 11,434.0     Queens              14,424,636.0             420,494.0   \n",
       "203 11,435.0     Queens               7,263,755.0           3,191,866.0   \n",
       "204 11,436.0     Queens               5,577,045.0              76,479.0   \n",
       "205 11,691.0     Queens               9,979,445.0           2,379,913.0   \n",
       "206 11,692.0     Queens               4,017,419.0             536,551.0   \n",
       "207 11,693.0     Queens               2,007,137.0             497,075.0   \n",
       "208 11,694.0     Queens               6,462,296.0           1,523,505.0   \n",
       "209 11,695.0     Queens                       0.0                   0.0   \n",
       "210 11,697.0     Queens               2,411,300.0                   0.0   \n",
       "211 12,345.0  Manhattan                       0.0                   0.0   \n",
       "\n",
       "     Multi-Family Elevator  Mixed Residential & Commercial  \\\n",
       "0              8,350,224.0                    13,875,477.0   \n",
       "1             16,618,352.0                    16,356,822.0   \n",
       "2             12,746,613.0                    15,687,708.0   \n",
       "3                725,023.0                     4,194,913.0   \n",
       "4              2,480,663.0                     5,683,041.0   \n",
       "5              2,406,484.0                     1,409,933.0   \n",
       "6             25,180,716.0                     7,113,948.0   \n",
       "7              7,867,831.0                    16,437,543.0   \n",
       "8              7,188,028.0                    14,478,911.0   \n",
       "9             14,800,035.0                    18,123,314.0   \n",
       "10             4,613,138.0                     9,531,808.0   \n",
       "11             5,779,311.0                    56,057,948.0   \n",
       "12             7,474,829.0                     8,185,370.0   \n",
       "13            13,831,161.0                    22,955,466.0   \n",
       "14             6,046,123.0                     6,548,307.0   \n",
       "15             3,240,209.0                     4,078,905.0   \n",
       "16            12,189,484.0                    34,487,557.0   \n",
       "17                     0.0                        18,000.0   \n",
       "18            20,806,893.0                    13,542,249.0   \n",
       "19            19,038,305.0                    16,970,483.0   \n",
       "20            21,279,942.0                    25,785,893.0   \n",
       "21            24,611,738.0                    15,215,282.0   \n",
       "22            32,659,777.0                    14,682,226.0   \n",
       "23             6,602,068.0                     5,660,989.0   \n",
       "24            12,757,706.0                     8,258,381.0   \n",
       "25            18,255,253.0                    13,731,428.0   \n",
       "26            17,265,845.0                    12,794,749.0   \n",
       "27             3,004,654.0                     4,303,357.0   \n",
       "28             9,886,916.0                     5,265,342.0   \n",
       "29             9,011,038.0                     7,150,092.0   \n",
       "..                     ...                             ...   \n",
       "182                    0.0                        70,619.0   \n",
       "183              154,824.0                       736,562.0   \n",
       "184                    0.0                       182,737.0   \n",
       "185            2,090,642.0                       289,219.0   \n",
       "186            5,196,781.0                     1,759,878.0   \n",
       "187                    0.0                       883,024.0   \n",
       "188                    0.0                       733,693.0   \n",
       "189            1,892,226.0                     1,718,639.0   \n",
       "190               46,760.0                     1,477,640.0   \n",
       "191                    0.0                       684,550.0   \n",
       "192            1,243,736.0                     1,273,895.0   \n",
       "193                    0.0                       185,024.0   \n",
       "194            1,678,238.0                       648,308.0   \n",
       "195              263,883.0                       140,416.0   \n",
       "196              437,087.0                       156,580.0   \n",
       "197              200,737.0                       619,449.0   \n",
       "198               98,116.0                       286,292.0   \n",
       "199                    0.0                             0.0   \n",
       "200            7,378,154.0                     4,107,566.0   \n",
       "201            1,509,858.0                       679,882.0   \n",
       "202            8,870,953.0                       528,147.0   \n",
       "203            6,810,531.0                     2,655,828.0   \n",
       "204                    0.0                       171,534.0   \n",
       "205            9,220,076.0                     1,378,914.0   \n",
       "206            3,390,311.0                       312,001.0   \n",
       "207            3,057,924.0                       167,249.0   \n",
       "208            2,726,703.0                       568,939.0   \n",
       "209                    0.0                             0.0   \n",
       "210                    0.0                             0.0   \n",
       "211                    0.0                        25,456.0   \n",
       "\n",
       "     Commercial & Office  Industrial & Manufacturing  \\\n",
       "0           53,005,101.0                 4,445,633.0   \n",
       "1            3,200,967.0                 1,182,700.0   \n",
       "2           10,760,299.0                   714,504.0   \n",
       "3           21,117,265.0                    85,472.0   \n",
       "4           16,515,733.0                         0.0   \n",
       "5            7,224,839.0                         0.0   \n",
       "6           26,421,102.0                   186,711.0   \n",
       "7            1,094,334.0                   132,152.0   \n",
       "8           16,348,068.0                   316,637.0   \n",
       "9           15,296,761.0                 1,648,286.0   \n",
       "10           6,921,166.0                   701,519.0   \n",
       "11          18,849,057.0                 2,494,273.0   \n",
       "12          10,160,665.0                   416,587.0   \n",
       "13          29,604,440.0                   670,902.0   \n",
       "14          59,741,723.0                         0.0   \n",
       "15          34,754,916.0                 4,832,798.0   \n",
       "16          45,803,364.0                   473,962.0   \n",
       "17          12,212,344.0                         0.0   \n",
       "18           1,997,043.0                     2,400.0   \n",
       "19          47,958,268.0                    55,175.0   \n",
       "20           3,974,104.0                         0.0   \n",
       "21           1,321,834.0                   103,576.0   \n",
       "22           1,606,729.0                   127,322.0   \n",
       "23             166,654.0                         0.0   \n",
       "24           3,931,787.0                   642,528.0   \n",
       "25             433,476.0                    44,183.0   \n",
       "26             975,600.0                   378,725.0   \n",
       "27             110,686.0                         0.0   \n",
       "28             453,007.0                   222,311.0   \n",
       "29             510,310.0                    24,714.0   \n",
       "..                   ...                         ...   \n",
       "182            299,776.0                         0.0   \n",
       "183            344,338.0                   527,030.0   \n",
       "184            752,809.0                 1,949,320.0   \n",
       "185            892,523.0                     1,400.0   \n",
       "186            994,338.0                    34,487.0   \n",
       "187            576,513.0                   466,978.0   \n",
       "188            568,005.0                   468,406.0   \n",
       "189          1,267,287.0                 1,583,916.0   \n",
       "190            686,233.0                   160,051.0   \n",
       "191            511,211.0                    53,846.0   \n",
       "192            296,284.0                    82,028.0   \n",
       "193            630,759.0                    81,696.0   \n",
       "194            419,783.0                 1,026,553.0   \n",
       "195            419,374.0                   137,706.0   \n",
       "196            194,145.0                         0.0   \n",
       "197            486,854.0                   123,195.0   \n",
       "198            295,565.0                   452,708.0   \n",
       "199            145,538.0                    42,400.0   \n",
       "200          2,917,690.0                    11,270.0   \n",
       "201          2,593,100.0                 2,103,300.0   \n",
       "202          1,808,663.0                 2,275,456.0   \n",
       "203          2,468,101.0                   952,046.0   \n",
       "204            919,551.0                    20,928.0   \n",
       "205            904,570.0                   387,791.0   \n",
       "206            139,526.0                    82,475.0   \n",
       "207            191,077.0                   297,651.0   \n",
       "208            577,988.0                    37,309.0   \n",
       "209                  0.0                         0.0   \n",
       "210                  0.0                         0.0   \n",
       "211                  0.0                         0.0   \n",
       "\n",
       "     Transportation & Utility  Public Facilities & Institutions  \\\n",
       "0                 1,182,594.0                      10,895,555.0   \n",
       "1                   590,077.0                       4,618,645.0   \n",
       "2                     3,459.0                       9,501,989.0   \n",
       "3                   462,543.0                       3,722,844.0   \n",
       "4                   682,450.0                          43,568.0   \n",
       "5                         0.0                         237,019.0   \n",
       "6                     6,565.0                       1,964,664.0   \n",
       "7                   175,000.0                       1,778,954.0   \n",
       "8                    65,745.0                       5,288,022.0   \n",
       "9                   464,332.0                       4,294,146.0   \n",
       "10                    2,303.0                       5,400,219.0   \n",
       "11                  277,723.0                       4,696,390.0   \n",
       "12                  767,117.0                       1,278,432.0   \n",
       "13                    6,150.0                       7,599,194.0   \n",
       "14                   74,550.0                       3,863,733.0   \n",
       "15                2,240,173.0                       1,651,025.0   \n",
       "16                  777,575.0                       5,264,467.0   \n",
       "17                        0.0                               0.0   \n",
       "18                   28,097.0                       6,228,936.0   \n",
       "19                  116,360.0                       1,589,981.0   \n",
       "20                        0.0                       4,571,429.0   \n",
       "21                        0.0                       3,887,400.0   \n",
       "22                   23,703.0                      19,291,758.0   \n",
       "23                        0.0                       1,381,636.0   \n",
       "24                  490,568.0                      11,486,677.0   \n",
       "25                   18,930.0                       1,476,654.0   \n",
       "26                  216,324.0                      10,062,118.0   \n",
       "27                        0.0                       1,341,992.0   \n",
       "28                   26,017.0                       3,936,851.0   \n",
       "29                   24,170.0                      11,198,145.0   \n",
       "..                        ...                               ...   \n",
       "182                   6,653.0                         682,868.0   \n",
       "183                  84,582.0                       1,006,467.0   \n",
       "184                  62,229.0                       1,174,929.0   \n",
       "185                   3,006.0                         504,989.0   \n",
       "186                   4,705.0                         780,491.0   \n",
       "187                 141,183.0                         701,896.0   \n",
       "188                  80,598.0                       1,244,651.0   \n",
       "189                  75,974.0                       1,968,887.0   \n",
       "190                  49,411.0                         626,089.0   \n",
       "191                  76,802.0                       1,159,866.0   \n",
       "192                  22,221.0                         455,308.0   \n",
       "193                  13,017.0                         613,022.0   \n",
       "194                  94,138.0                         839,545.0   \n",
       "195                  12,273.0                       1,077,723.0   \n",
       "196                   5,985.0                       2,444,529.0   \n",
       "197                  54,336.0                         781,900.0   \n",
       "198                 320,215.0                         569,612.0   \n",
       "199              17,280,787.0                          29,000.0   \n",
       "200                  16,398.0                      10,079,934.0   \n",
       "201                 335,764.0                       2,414,571.0   \n",
       "202                 179,473.0                       2,814,011.0   \n",
       "203                 171,412.0                       2,453,715.0   \n",
       "204                  10,334.0                         688,660.0   \n",
       "205                 141,782.0                       3,118,445.0   \n",
       "206                  43,445.0                         632,900.0   \n",
       "207                       0.0                         382,212.0   \n",
       "208                  27,067.0                       1,570,910.0   \n",
       "209                       0.0                               0.0   \n",
       "210                       0.0                         261,550.0   \n",
       "211                       0.0                               0.0   \n",
       "\n",
       "     Open Space & Outdoor Recreation   Parking  Vacant Land  \n",
       "0                        1,152,624.0 616,150.0          0.0  \n",
       "1                           87,067.0 252,263.0          0.0  \n",
       "2                          126,922.0 159,151.0          0.0  \n",
       "3                          945,425.0  87,775.0          0.0  \n",
       "4                                0.0       0.0          0.0  \n",
       "5                                0.0 305,026.0          0.0  \n",
       "6                                0.0       0.0          0.0  \n",
       "7                           52,703.0   3,358.0          0.0  \n",
       "8                           20,206.0  84,013.0          0.0  \n",
       "9                           12,323.0  78,016.0          0.0  \n",
       "10                             825.0  81,080.0          0.0  \n",
       "11                          20,783.0 252,788.0          0.0  \n",
       "12                          54,398.0 255,804.0          0.0  \n",
       "13                          12,406.0 261,082.0          0.0  \n",
       "14                             796.0  61,700.0          0.0  \n",
       "15                               0.0 679,012.0          0.0  \n",
       "16                          20,600.0 191,488.0          0.0  \n",
       "17                               0.0       0.0          0.0  \n",
       "18                               0.0 222,378.0          0.0  \n",
       "19                             912.0 206,094.0          0.0  \n",
       "20                          58,219.0  62,555.0          0.0  \n",
       "21                           4,700.0 147,492.0          0.0  \n",
       "22                          27,963.0 295,453.0          0.0  \n",
       "23                               0.0       0.0          0.0  \n",
       "24                          43,361.0 215,066.0          0.0  \n",
       "25                           7,500.0  54,731.0          0.0  \n",
       "26                          24,487.0 676,748.0          0.0  \n",
       "27                           1,410.0  56,356.0          0.0  \n",
       "28                          13,600.0  46,200.0          0.0  \n",
       "29                         258,931.0 671,660.0          0.0  \n",
       "..                               ...       ...          ...  \n",
       "182                              0.0       0.0          0.0  \n",
       "183                            612.0   3,242.0          0.0  \n",
       "184                          9,656.0   4,900.0          0.0  \n",
       "185                          8,044.0     800.0          0.0  \n",
       "186                         20,303.0   4,902.0          0.0  \n",
       "187                            904.0  24,385.0          0.0  \n",
       "188                         69,755.0  33,567.0          0.0  \n",
       "189                              0.0 101,247.0          0.0  \n",
       "190                            900.0   3,138.0          0.0  \n",
       "191                      2,058,532.0   3,024.0          0.0  \n",
       "192                         27,240.0   3,700.0          0.0  \n",
       "193                          1,125.0   7,660.0          0.0  \n",
       "194                          1,360.0  70,060.0          0.0  \n",
       "195                          1,511.0   4,092.0          0.0  \n",
       "196                          8,832.0   2,200.0          0.0  \n",
       "197                              0.0   1,560.0          0.0  \n",
       "198                            800.0  14,225.0          0.0  \n",
       "199                              0.0   1,575.0          0.0  \n",
       "200                          1,000.0 347,427.0          0.0  \n",
       "201                         12,590.0 303,009.0          0.0  \n",
       "202                         56,693.0 269,331.0          0.0  \n",
       "203                         42,550.0 164,576.0          0.0  \n",
       "204                            600.0       0.0          0.0  \n",
       "205                         22,917.0  15,738.0      4,168.0  \n",
       "206                         75,638.0  49,304.0          0.0  \n",
       "207                         66,441.0  16,344.0          0.0  \n",
       "208                              0.0   4,500.0          0.0  \n",
       "209                         62,000.0       0.0          0.0  \n",
       "210                     12,252,000.0       0.0          0.0  \n",
       "211                              0.0       0.0          0.0  \n",
       "\n",
       "[212 rows x 13 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "landuse_df.rename(columns = cols_dict, inplace=True)\n",
    "landuse_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create Database file for Flask app"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "database_path = \"../zipcodeDB.sqlite\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create Engine\n",
    "# will create sqlite file if it doesn't already exist\n",
    "engine = create_engine(f\"sqlite:///{database_path}\")\n",
    "conn = engine.connect()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Push data to database\n",
    "landuse_df.to_sql(name=\"zip_table\", con=conn, if_exists =\"replace\", index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Run Initial Query And Find Nearest Neighbor"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# Specify target zipcode\n",
    "\n",
    "#zipcode = 11101 #Long Island City, QNS\n",
    "#zipcode = 11104 #Sunnyside, QNS\n",
    "#zipcode = 11355 #Flushing, QNS\n",
    "#zipcode = 11201 #Brooklyn Heights, BK\n",
    "#zipcode = 10304 #Todt Hill, SI\n",
    "#zipcode = 10016 #Murray Hill"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 173,
   "metadata": {},
   "outputs": [],
   "source": [
    "database_path = \"../zipcodeDB.sqlite\"\n",
    "\n",
    "# Create Engine\n",
    "# will create sqlite file if it doesn't already exist\n",
    "engine = create_engine(f\"sqlite:///{database_path}\")\n",
    "conn = engine.connect()\n",
    "\n",
    "# Query records to test that it works\n",
    "data_df = pd.read_sql(\"SELECT * FROM zip_table\", conn)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>zipcode</th>\n",
       "      <th>borocode</th>\n",
       "      <th>1 &amp; 2 Family Residential</th>\n",
       "      <th>Multi-Family Walk-up</th>\n",
       "      <th>Multi-Family Elevator</th>\n",
       "      <th>Mixed Residential &amp; Commercial</th>\n",
       "      <th>Commercial &amp; Office</th>\n",
       "      <th>Industrial &amp; Manufacturing</th>\n",
       "      <th>Transportation &amp; Utility</th>\n",
       "      <th>Public Facilities &amp; Institutions</th>\n",
       "      <th>Open Space &amp; Outdoor Recreation</th>\n",
       "      <th>Parking</th>\n",
       "      <th>Vacant Land</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10,001.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>33,606.0</td>\n",
       "      <td>592,289.0</td>\n",
       "      <td>8,350,224.0</td>\n",
       "      <td>13,875,477.0</td>\n",
       "      <td>53,005,101.0</td>\n",
       "      <td>4,445,633.0</td>\n",
       "      <td>1,182,594.0</td>\n",
       "      <td>10,895,555.0</td>\n",
       "      <td>1,152,624.0</td>\n",
       "      <td>616,150.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10,002.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>51,117.0</td>\n",
       "      <td>1,938,379.0</td>\n",
       "      <td>16,618,352.0</td>\n",
       "      <td>16,356,822.0</td>\n",
       "      <td>3,200,967.0</td>\n",
       "      <td>1,182,700.0</td>\n",
       "      <td>590,077.0</td>\n",
       "      <td>4,618,645.0</td>\n",
       "      <td>87,067.0</td>\n",
       "      <td>252,263.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10,003.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>515,395.0</td>\n",
       "      <td>3,786,590.0</td>\n",
       "      <td>12,746,613.0</td>\n",
       "      <td>15,687,708.0</td>\n",
       "      <td>10,760,299.0</td>\n",
       "      <td>714,504.0</td>\n",
       "      <td>3,459.0</td>\n",
       "      <td>9,501,989.0</td>\n",
       "      <td>126,922.0</td>\n",
       "      <td>159,151.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10,004.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>725,023.0</td>\n",
       "      <td>4,194,913.0</td>\n",
       "      <td>21,117,265.0</td>\n",
       "      <td>85,472.0</td>\n",
       "      <td>462,543.0</td>\n",
       "      <td>3,722,844.0</td>\n",
       "      <td>945,425.0</td>\n",
       "      <td>87,775.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10,005.0</td>\n",
       "      <td>Manhattan</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2,480,663.0</td>\n",
       "      <td>5,683,041.0</td>\n",
       "      <td>16,515,733.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>682,450.0</td>\n",
       "      <td>43,568.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   zipcode   borocode  1 & 2 Family Residential  Multi-Family Walk-up  \\\n",
       "0 10,001.0  Manhattan                  33,606.0             592,289.0   \n",
       "1 10,002.0  Manhattan                  51,117.0           1,938,379.0   \n",
       "2 10,003.0  Manhattan                 515,395.0           3,786,590.0   \n",
       "3 10,004.0  Manhattan                       0.0                   0.0   \n",
       "4 10,005.0  Manhattan                       0.0                   0.0   \n",
       "\n",
       "   Multi-Family Elevator  Mixed Residential & Commercial  Commercial & Office  \\\n",
       "0            8,350,224.0                    13,875,477.0         53,005,101.0   \n",
       "1           16,618,352.0                    16,356,822.0          3,200,967.0   \n",
       "2           12,746,613.0                    15,687,708.0         10,760,299.0   \n",
       "3              725,023.0                     4,194,913.0         21,117,265.0   \n",
       "4            2,480,663.0                     5,683,041.0         16,515,733.0   \n",
       "\n",
       "   Industrial & Manufacturing  Transportation & Utility  \\\n",
       "0                 4,445,633.0               1,182,594.0   \n",
       "1                 1,182,700.0                 590,077.0   \n",
       "2                   714,504.0                   3,459.0   \n",
       "3                    85,472.0                 462,543.0   \n",
       "4                         0.0                 682,450.0   \n",
       "\n",
       "   Public Facilities & Institutions  Open Space & Outdoor Recreation  \\\n",
       "0                      10,895,555.0                      1,152,624.0   \n",
       "1                       4,618,645.0                         87,067.0   \n",
       "2                       9,501,989.0                        126,922.0   \n",
       "3                       3,722,844.0                        945,425.0   \n",
       "4                          43,568.0                              0.0   \n",
       "\n",
       "    Parking  Vacant Land  \n",
       "0 616,150.0          0.0  \n",
       "1 252,263.0          0.0  \n",
       "2 159,151.0          0.0  \n",
       "3  87,775.0          0.0  \n",
       "4       0.0          0.0  "
      ]
     },
     "execution_count": 176,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# Split DFs so that selected outer-borough zipcode can find nearest neighbor zip in Manhattan\n",
    "manhattan_df = data_df[data_df.borocode == \"Manhattan\"]\n",
    "outer_borough_df = data_df[data_df.borocode != \"Manhattan\"]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create dictObj\n",
    "# This formatting is reuired for the D3 chart, and is (believe it or not) the cleanest solution I could come up with...\n",
    "dictObj = {\"manhattan\": {\"borough\": \"Manhattan\",\n",
    "                         \"zipcode\": None,\n",
    "                         \"neighborhood\": None,\n",
    "                         \"values\": {\"0\": {\"color\": \"#FFDD80\", \n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"1 & 2 Family Residential\"},\n",
    "                                    \"1\": {\"color\": \"#ff9100\",\n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"Multi-Family Walk-up\"},\n",
    "                                    \"2\": {\"color\": \"#bf360c\",\n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"Multi-Family Elevator\"},\n",
    "                                    \"3\": {\"color\": \"#ff5252\",\n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"Mixed Residential & Commercial\"},\n",
    "                                    \"4\": {\"color\": \"#c51162\",\n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"Commercial & Office\"},\n",
    "                                    \"5\": {\"color\": \"#7b1fa2\",\n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"Industrial & Manufacturing\"},\n",
    "                                    \"6\": {\"color\": \"#ba68c8\",\n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"Transportation & Utility\"},\n",
    "                                    \"7\": {\"color\": \"#0d47a1\",\n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"Public Facilities & Institutions\"},\n",
    "                                    \"8\": {\"color\": \"#00bfa5\",\n",
    "                                          \"GFA\": None,\n",
    "                                          \"label\": \"Open Space & Outdoor Recreation\"},\n",
    "                                    \"9\": {\"color\": \"#607d8b\",\n",
    "                                          \"GFA\": None, \n",
    "                                          \"label\": \"Parking\"},\n",
    "                                    \"10\": {\"color\": \"#263238\",\n",
    "                                           \"GFA\": None,\n",
    "                                           \"label\": \"Vacant Land\"}\n",
    "                                   }\n",
    "                        },\n",
    "           \"outer-borough\": {\"borough\": None,\n",
    "                             \"zipcode\": None,\n",
    "                             \"Neighborhood\": None,\n",
    "                             \"values\": {\"0\": {\"color\": \"#FFDD80\", \n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"1 & 2 Family Residential\"},\n",
    "                                        \"1\": {\"color\": \"#ff9100\",\n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"Multi-Family Walk-up\"},\n",
    "                                        \"2\": {\"color\": \"#bf360c\",\n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"Multi-Family Elevator\"},\n",
    "                                        \"3\": {\"color\": \"#ff5252\",\n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"Mixed Residential & Commercial\"},\n",
    "                                        \"4\": {\"color\": \"#c51162\",\n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"Commercial & Office\"},\n",
    "                                        \"5\": {\"color\": \"#7b1fa2\",\n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"Industrial & Manufacturing\"},\n",
    "                                        \"6\": {\"color\": \"#ba68c8\",\n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"Transportation & Utility\"},\n",
    "                                        \"7\": {\"color\": \"#0d47a1\",\n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"Public Facilities & Institutions\"},\n",
    "                                        \"8\": {\"color\": \"#00bfa5\",\n",
    "                                              \"GFA\": None,\n",
    "                                              \"label\": \"Open Space & Outdoor Recreation\"},\n",
    "                                        \"9\": {\"color\": \"#607d8b\",\n",
    "                                              \"GFA\": None, \n",
    "                                              \"label\": \"Parking\"},\n",
    "                                        \"10\": {\"color\": \"#263238\",\n",
    "                                               \"GFA\": None,\n",
    "                                               \"label\": \"Vacant Land\"}\n",
    "                                   }\n",
    "                        }\n",
    "          }\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "metadata": {},
   "outputs": [],
   "source": [
    "target_borough = data_df.borocode[data_df.zipcode == zipcode].tolist()[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Staten Island'"
      ]
     },
     "execution_count": 187,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "target_borough"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Initial Query"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "metadata": {},
   "outputs": [],
   "source": [
    "if target_borough == 'Manhattan':\n",
    "    # Pull out target zipcode from manhattan_df\n",
    "    target_df = manhattan_df[manhattan_df.zipcode == zipcode]\n",
    "    \n",
    "    # Define zipcode\n",
    "    dictObj[\"manhattan\"][\"zipcode\"] = zipcode\n",
    "    \n",
    "    for item in dictObj[\"manhattan\"][\"values\"]:\n",
    "        value_type = dictObj[\"manhattan\"][\"values\"][item][\"label\"]\n",
    "        dictObj[\"manhattan\"][\"values\"][item][\"GFA\"] = target_df[value_type].tolist()[0]\n",
    "    \n",
    "    \n",
    "else:\n",
    "    # Pull out target zipcode from outer_borough_df\n",
    "    target_df = outer_borough_df[outer_borough_df.zipcode == zipcode]\n",
    "    \n",
    "    # Define zipcode and borough\n",
    "    dictObj[\"outer-borough\"][\"zipcode\"] = int(zipcode)\n",
    "    dictObj[\"outer-borough\"][\"borough\"] = target_borough\n",
    "    \n",
    "    for item in dictObj[\"outer-borough\"][\"values\"]:\n",
    "        value_type = dictObj[\"outer-borough\"][\"values\"][item][\"label\"]\n",
    "        dictObj[\"outer-borough\"][\"values\"][item][\"GFA\"] = target_df[value_type].tolist()[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 189,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'manhattan': {'borough': 'Manhattan',\n",
      "               'neighborhood': None,\n",
      "               'values': {'0': {'GFA': None,\n",
      "                                'color': '#FFDD80',\n",
      "                                'label': '1 & 2 Family Residential'},\n",
      "                          '1': {'GFA': None,\n",
      "                                'color': '#ff9100',\n",
      "                                'label': 'Multi-Family Walk-up'},\n",
      "                          '10': {'GFA': None,\n",
      "                                 'color': '#263238',\n",
      "                                 'label': 'Vacant Land'},\n",
      "                          '2': {'GFA': None,\n",
      "                                'color': '#bf360c',\n",
      "                                'label': 'Multi-Family Elevator'},\n",
      "                          '3': {'GFA': None,\n",
      "                                'color': '#ff5252',\n",
      "                                'label': 'Mixed Residential & Commercial'},\n",
      "                          '4': {'GFA': None,\n",
      "                                'color': '#c51162',\n",
      "                                'label': 'Commercial & Office'},\n",
      "                          '5': {'GFA': None,\n",
      "                                'color': '#7b1fa2',\n",
      "                                'label': 'Industrial & Manufacturing'},\n",
      "                          '6': {'GFA': None,\n",
      "                                'color': '#ba68c8',\n",
      "                                'label': 'Transportation & Utility'},\n",
      "                          '7': {'GFA': None,\n",
      "                                'color': '#0d47a1',\n",
      "                                'label': 'Public Facilities & Institutions'},\n",
      "                          '8': {'GFA': None,\n",
      "                                'color': '#00bfa5',\n",
      "                                'label': 'Open Space & Outdoor Recreation'},\n",
      "                          '9': {'GFA': None,\n",
      "                                'color': '#607d8b',\n",
      "                                'label': 'Parking'}},\n",
      "               'zipcode': None},\n",
      " 'outer-borough': {'Neighborhood': None,\n",
      "                   'borough': 'Staten Island',\n",
      "                   'values': {'0': {'GFA': 14242428.0,\n",
      "                                    'color': '#FFDD80',\n",
      "                                    'label': '1 & 2 Family Residential'},\n",
      "                              '1': {'GFA': 1899750.0,\n",
      "                                    'color': '#ff9100',\n",
      "                                    'label': 'Multi-Family Walk-up'},\n",
      "                              '10': {'GFA': 0.0,\n",
      "                                     'color': '#263238',\n",
      "                                     'label': 'Vacant Land'},\n",
      "                              '2': {'GFA': 3222559.0,\n",
      "                                    'color': '#bf360c',\n",
      "                                    'label': 'Multi-Family Elevator'},\n",
      "                              '3': {'GFA': 1417842.0,\n",
      "                                    'color': '#ff5252',\n",
      "                                    'label': 'Mixed Residential & Commercial'},\n",
      "                              '4': {'GFA': 1085077.0,\n",
      "                                    'color': '#c51162',\n",
      "                                    'label': 'Commercial & Office'},\n",
      "                              '5': {'GFA': 435189.0,\n",
      "                                    'color': '#7b1fa2',\n",
      "                                    'label': 'Industrial & Manufacturing'},\n",
      "                              '6': {'GFA': 70512.0,\n",
      "                                    'color': '#ba68c8',\n",
      "                                    'label': 'Transportation & Utility'},\n",
      "                              '7': {'GFA': 2456708.0,\n",
      "                                    'color': '#0d47a1',\n",
      "                                    'label': 'Public Facilities & '\n",
      "                                             'Institutions'},\n",
      "                              '8': {'GFA': 65787.0,\n",
      "                                    'color': '#00bfa5',\n",
      "                                    'label': 'Open Space & Outdoor Recreation'},\n",
      "                              '9': {'GFA': 29529.0,\n",
      "                                    'color': '#607d8b',\n",
      "                                    'label': 'Parking'}},\n",
      "                   'zipcode': 10304}}\n"
     ]
    }
   ],
   "source": [
    "# Either Manhattan or Outer Borough GFA should be empty\n",
    "pprint(dictObj)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### KNN"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "metadata": {},
   "outputs": [],
   "source": [
    "if target_borough == 'Manhattan': #i.e. the nearest neighbor will NOT be in Manhattan\n",
    "\n",
    "    # Combine with Outerborough df to train model\n",
    "    train_data = pd.concat([target_df, outer_borough_df])\n",
    "\n",
    "    # Drop column with strings (b/c KNN needs numeric data) and reset index\n",
    "    train_data.drop(\"borocode\", axis=1, inplace=True)\n",
    "    train_data.reset_index(drop=True, inplace=True)\n",
    "    \n",
    "    # Train Nearest Neighbors model\n",
    "    nbrs = NearestNeighbors(n_neighbors=2, algorithm='ball_tree').fit(train_data)\n",
    "    distances, indices = nbrs.kneighbors(train_data)\n",
    "\n",
    "    # Find nearest neighbor\n",
    "    nearest_neighbor_index = indices[0][1]\n",
    "    result = train_data.iloc[nearest_neighbor_index, :]\n",
    "    result_borough = data_df.borocode[data_df.zipcode == result.zipcode].tolist()[0]\n",
    "    \n",
    "    # Define zipcode and borough\n",
    "    result_zipcode = int(result[\"zipcode\"])\n",
    "    result_borough = data_df[data_df.zipcode == result[\"zipcode\"]].borocode.tolist()[0]\n",
    "    dictObj[\"outer-borough\"][\"zipcode\"] = result_zipcode\n",
    "    dictObj[\"outer-borough\"][\"borough\"] = result_borough\n",
    "    \n",
    "    for item in dictObj[\"outer-borough\"][\"values\"]:\n",
    "        value_type = dictObj[\"outer-borough\"][\"values\"][item][\"label\"]\n",
    "        dictObj[\"outer-borough\"][\"values\"][item][\"GFA\"] = result[value_type]\n",
    "\n",
    "        \n",
    "else: # i.e. the nearest neighbor IS in Manhattan\n",
    "\n",
    "    # Combine with Manhattan df to train model\n",
    "    train_data = pd.concat([target_df, manhattan_df])\n",
    "    \n",
    "    # Drop column with strings and reset index\n",
    "    train_data.drop(\"borocode\", axis=1, inplace=True)\n",
    "    train_data.reset_index(drop=True, inplace=True)\n",
    "    \n",
    "    # Train Nearest Neighbors model\n",
    "    nbrs = NearestNeighbors(n_neighbors=2, algorithm='ball_tree').fit(train_data)\n",
    "    distances, indices = nbrs.kneighbors(train_data)\n",
    "\n",
    "    # Find nearest neighbor\n",
    "    nearest_neighbor_index = indices[0][1]\n",
    "    result = train_data.iloc[nearest_neighbor_index, :]\n",
    "    result_borough = data_df.borocode[data_df.zipcode == result.zipcode].tolist()[0]\n",
    "    \n",
    "    # Define zipcode and borough\n",
    "    result_zipcode = int(result[\"zipcode\"])\n",
    "    result_borough = data_df[data_df.zipcode == result[\"zipcode\"]].borocode.tolist()[0]\n",
    "    dictObj[\"manhattan\"][\"zipcode\"] = result_zipcode\n",
    "    dictObj[\"manhattan\"][\"borough\"] = result_borough\n",
    "    \n",
    "    for item in dictObj[\"manhattan\"][\"values\"]:\n",
    "        value_type = dictObj[\"manhattan\"][\"values\"][item][\"label\"]\n",
    "        dictObj[\"manhattan\"][\"values\"][item][\"GFA\"] = result[value_type]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "{'manhattan': {'borough': 'Manhattan',\n",
      "               'neighborhood': None,\n",
      "               'values': {'0': {'GFA': 774088.0,\n",
      "                                'color': '#FFDD80',\n",
      "                                'label': '1 & 2 Family Residential'},\n",
      "                          '1': {'GFA': 4628963.0,\n",
      "                                'color': '#ff9100',\n",
      "                                'label': 'Multi-Family Walk-up'},\n",
      "                          '10': {'GFA': 0.0,\n",
      "                                 'color': '#263238',\n",
      "                                 'label': 'Vacant Land'},\n",
      "                          '2': {'GFA': 3004654.0,\n",
      "                                'color': '#bf360c',\n",
      "                                'label': 'Multi-Family Elevator'},\n",
      "                          '3': {'GFA': 4303357.0,\n",
      "                                'color': '#ff5252',\n",
      "                                'label': 'Mixed Residential & Commercial'},\n",
      "                          '4': {'GFA': 110686.0,\n",
      "                                'color': '#c51162',\n",
      "                                'label': 'Commercial & Office'},\n",
      "                          '5': {'GFA': 0.0,\n",
      "                                'color': '#7b1fa2',\n",
      "                                'label': 'Industrial & Manufacturing'},\n",
      "                          '6': {'GFA': 0.0,\n",
      "                                'color': '#ba68c8',\n",
      "                                'label': 'Transportation & Utility'},\n",
      "                          '7': {'GFA': 1341992.0,\n",
      "                                'color': '#0d47a1',\n",
      "                                'label': 'Public Facilities & Institutions'},\n",
      "                          '8': {'GFA': 1410.0,\n",
      "                                'color': '#00bfa5',\n",
      "                                'label': 'Open Space & Outdoor Recreation'},\n",
      "                          '9': {'GFA': 56356.0,\n",
      "                                'color': '#607d8b',\n",
      "                                'label': 'Parking'}},\n",
      "               'zipcode': 10030},\n",
      " 'outer-borough': {'Neighborhood': None,\n",
      "                   'borough': 'Staten Island',\n",
      "                   'values': {'0': {'GFA': 14242428.0,\n",
      "                                    'color': '#FFDD80',\n",
      "                                    'label': '1 & 2 Family Residential'},\n",
      "                              '1': {'GFA': 1899750.0,\n",
      "                                    'color': '#ff9100',\n",
      "                                    'label': 'Multi-Family Walk-up'},\n",
      "                              '10': {'GFA': 0.0,\n",
      "                                     'color': '#263238',\n",
      "                                     'label': 'Vacant Land'},\n",
      "                              '2': {'GFA': 3222559.0,\n",
      "                                    'color': '#bf360c',\n",
      "                                    'label': 'Multi-Family Elevator'},\n",
      "                              '3': {'GFA': 1417842.0,\n",
      "                                    'color': '#ff5252',\n",
      "                                    'label': 'Mixed Residential & Commercial'},\n",
      "                              '4': {'GFA': 1085077.0,\n",
      "                                    'color': '#c51162',\n",
      "                                    'label': 'Commercial & Office'},\n",
      "                              '5': {'GFA': 435189.0,\n",
      "                                    'color': '#7b1fa2',\n",
      "                                    'label': 'Industrial & Manufacturing'},\n",
      "                              '6': {'GFA': 70512.0,\n",
      "                                    'color': '#ba68c8',\n",
      "                                    'label': 'Transportation & Utility'},\n",
      "                              '7': {'GFA': 2456708.0,\n",
      "                                    'color': '#0d47a1',\n",
      "                                    'label': 'Public Facilities & '\n",
      "                                             'Institutions'},\n",
      "                              '8': {'GFA': 65787.0,\n",
      "                                    'color': '#00bfa5',\n",
      "                                    'label': 'Open Space & Outdoor Recreation'},\n",
      "                              '9': {'GFA': 29529.0,\n",
      "                                    'color': '#607d8b',\n",
      "                                    'label': 'Parking'}},\n",
      "                   'zipcode': 10304}}\n"
     ]
    }
   ],
   "source": [
    "pprint(dictObj)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
